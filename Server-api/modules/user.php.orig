<?php
	require_once 'db/dbHelper.php';
	require_once 'db/passwordHash.php';
	require_once 'db/session.php';
	require_once 'users/login.php';
	require_once 'users/getUsers.php';
	require_once 'users/register.php';
	
	$db = new dbHelper();
	
	$reqMethod = $app->request->getMethod();
<<<<<<< HEAD

	if($reqMethod=="GET"){
		if(isset($id)){
			$where['id'] = $id;
			$data = $db->select("users", $where);
			echo json_encode($data);
			
		}else{			
			$like = [];
			if(isset($_GET['search']) && $_GET['search'] == true){	
              
				(isset($_GET['username'])) ? $like['username'] = $_GET['username'] : "";
			}	
				
			$where=[]; // this will used for user specific data selection.
			$limit['pageNo'] = $pageNo; // from which record to select
			$limit['records'] = $records; // how many records to select
			
			// to check user_id is set or not
			((isset($_GET['user_id'])) && ($_GET['user_id']!=="")) ? $where['user_id'] = $_GET['user_id'] : "";			
			(isset($_GET['status'])) ? $where['status'] = $_GET['status'] : "";
			
			// this is used to select data with LIMIT & where clause
			$data = $db->select("users", $where, $limit,$like);
			
			// this is used to count totalRecords with only where clause
			$totalRecords['totalRecords'] = count($db->select("users", $where)['data']);		
			
			// $data is array & $totalRecords is also array. So for final output we just merge these two arrays into $data array
			$data = array_merge($totalRecords,$data);
			echo json_encode($data);
=======
	
	//getMethod
	if($reqMethod=="GET"){
		if(isset($getRequest) && $getRequest =='session'){
			getSession($getRequest);
		}elseif(isset($getRequest) && $getRequest =='logout'){
			logout();
		}else{
			if(isset($id)){
				getSingleUser();
			}else{
				getMultipleUsers(); // from getUsers.php
			}
>>>>>>> 3f3bde39613ddeab6a011233102478dfcd83c67b
		}
	}//end get
	
	if($reqMethod=="POST"){
		if(isset($postParams) && $postParams == 'login'){
			doLogin($body);
		}elseif(isset($postParams) && $postParams == 'register'){
			registerUser($body);
		}elseif(isset($postParams) && $postParams == 'forgotpass'){
			forgotPass($body);
		}
	}
	
	if($reqMethod=="PUT" || $reqMethod=="DELETE"){
<<<<<<< HEAD
		$where['id'] = $id; // need where clause to update/delete record
		
		$update = $db->update("users", $body, $where);
		echo json_encode($update);
=======
		echo $reqMethod;
		echo $body;
>>>>>>> 3f3bde39613ddeab6a011233102478dfcd83c67b
	}

 ?>